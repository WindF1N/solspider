#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—Ä–∞—É–∑–µ—Ä–∞
–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è IndexedDB –∏ Local Storage
"""

import time
import subprocess
import sys
from pathlib import Path

# –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è Windows (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ WSL)
CREATE_NO_WINDOW = 0x08000000

def refresh_existing_window(url="https://trade.padre.gg/trade/solana/TQnDxmfeV9G2cVPywPG5q5Ri37RNCoRyTzA7TLsvnt1"):
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –≤–º–µ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤–æ–≥–æ
    """
    print(f"üîÑ –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞...")

    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–æ–º–µ–Ω –∏–∑ URL –¥–ª—è –ø–æ–∏—Å–∫–∞
        from urllib.parse import urlparse
        domain = urlparse(url).netloc

        # –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ PowerShell - –Ω–∞—Ö–æ–¥–∏–º –æ–∫–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º F5 (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
        try:
            # PowerShell —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–∫–Ω–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∞–≤–∏—à–∏ F5
            ps_script = f"""
            Add-Type -AssemblyName System.Windows.Forms
            $processes = Get-Process msedge -ErrorAction SilentlyContinue
            Write-Host "–ü–æ–∏—Å–∫ –æ–∫–æ–Ω –±—Ä–∞—É–∑–µ—Ä–∞..."
            $found = $false
            foreach ($process in $processes) {{
                $title = $process.MainWindowTitle
                Write-Host "–ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–Ω–æ: '$title'"
                if ($title -like '*{domain}*' -or $title -like '*trade.padre.gg*' -or $title -like '*padre*') {{
                    Write-Host "–ù–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –æ–∫–Ω–æ: '$title'"
                    Write-Host "–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫–Ω–æ, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π URL –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ –≤–∫–ª–∞–¥–∫–∏..."
                    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞
                    $process | Select-Object -First 1 | ForEach-Object {{
                        [Microsoft.VisualBasic.Interaction]::AppActivate($_.Id)
                    }}
                    Start-Sleep -Milliseconds 500

                    # –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π URL –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ (Ctrl+T, –∑–∞—Ç–µ–º –≤–≤–æ–¥–∏–º URL)
                    Write-Host "–û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å –Ω—É–∂–Ω—ã–º URL..."
                    [System.Windows.Forms.SendKeys]::SendWait('^t')  # Ctrl+T –¥–ª—è –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
                    Start-Sleep -Milliseconds 300
                    [System.Windows.Forms.SendKeys]::SendWait('{url}')  # –í–≤–æ–¥–∏–º URL
                    Start-Sleep -Milliseconds 200
                    [System.Windows.Forms.SendKeys]::SendWait('~')  # Enter
                    Start-Sleep -Milliseconds 1000  # –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

                    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ –≤–∫–ª–∞–¥–∫–∏ (Ctrl+W –¥–ª—è –∫–∞–∂–¥–æ–π –≤–∫–ª–∞–¥–∫–∏)
                    Write-Host "–ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ –≤–∫–ª–∞–¥–∫–∏..."
                    # –ü–æ–≤—Ç–æ—Ä—è–µ–º Ctrl+W –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–π
                    for ($i = 1; $i -le 10; $i++) {{
                        [System.Windows.Forms.SendKeys]::SendWait('^w')  # Ctrl+W –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤–∫–ª–∞–¥–∫—É
                        Start-Sleep -Milliseconds 200
                    }}
                    Start-Sleep -Milliseconds 500

                    Write-Host "–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞: $($process.Id)"
                    $found = $true
                    exit 0
                }}
            }}
            if (-not $found) {{
                Write-Host "–ü–æ–¥—Ö–æ–¥—è—â–µ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
            }}
            exit 1
            """

            cmd = ["powershell.exe", "-Command", ps_script]
            result = subprocess.run(cmd, capture_output=True, timeout=10, text=True, encoding='cp1251')

            if result.returncode == 0 and "–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã" in result.stdout:
                print("‚úÖ –û–∫–Ω–æ –Ω–∞–π–¥–µ–Ω–æ, URL –æ—Ç–∫—Ä—ã—Ç –∏ –¥—Ä—É–≥–∏–µ –≤–∫–ª–∞–¥–∫–∏ –∑–∞–∫—Ä—ã—Ç—ã")
                return True  # –£–°–ü–ï–•! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è —Å—Ä–∞–∑—É
            else:
                print(f"‚ö†Ô∏è –û–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å: {result.stdout.strip()}")

        except Exception as e:
            print(f"‚ö†Ô∏è PowerShell –º–µ—Ç–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

        # –°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ --app –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ
        try:
            print(f"üîÑ –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å {url} –≤ —Ä–µ–∂–∏–º–µ --app...")
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º --app —Ä–µ–∂–∏–º –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            cmd = ["cmd.exe", "/c", f'start msedge.exe --app="{url}"']
            subprocess.run(cmd, shell=True, capture_output=True, timeout=5)
            print("‚úÖ URL –æ—Ç–∫—Ä—ã—Ç –≤ —Ä–µ–∂–∏–º–µ --app (–æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)")
            return True
        except Exception as e:
            print(f"‚ö†Ô∏è –†–µ–∂–∏–º --app –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

        # –°–ø–æ—Å–æ–± 3: –ü–∞—Ä–∞–º–µ—Ç—Ä --new-tab (–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≤–∫–ª–∞–¥–∫—É)
        try:
            print(f"üîÑ –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å {url} —á–µ—Ä–µ–∑ --new-tab...")
            cmd = ["cmd.exe", "/c", f'start msedge.exe --new-tab "{url}"']
            subprocess.run(cmd, shell=True, capture_output=True, timeout=5)
            print("‚úÖ URL –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ --new-tab (–¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –æ–∫–Ω–æ)")
            return True
        except Exception as e:
            print(f"‚ö†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä --new-tab –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

        # –°–ø–æ—Å–æ–± 4: –ß–µ—Ä–µ–∑ PowerShell –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        try:
            ps_script2 = f"""
            try {{
                Write-Host "–ó–∞–ø—É—Å–∫ Edge —Å URL: {url}"
                Start-Process "msedge.exe" -ArgumentList "{url}"
                Write-Host "Edge –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ"
                exit 0
            }} catch {{
                Write-Host "–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ Edge"
                exit 1
            }}
            """

            cmd = ["powershell.exe", "-Command", ps_script2]
            result = subprocess.run(cmd, capture_output=True, timeout=5, text=True, encoding='cp1251')

            if result.returncode == 0:
                print("‚úÖ Edge –∑–∞–ø—É—â–µ–Ω —Å URL (–¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≤–∫–ª–∞–¥–∫—É)")
                return True
            else:
                print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å Edge: {result.stdout.strip()}")

        except Exception as e:
            print(f"‚ö†Ô∏è PowerShell –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

        # –°–ø–æ—Å–æ–± 5: –ß–µ—Ä–µ–∑ wslview (–¥–ª—è WSL)
        try:
            subprocess.run(["wslview", url], capture_output=True, timeout=10)
            print("‚úÖ Edge –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ wslview (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –æ–∫–Ω–æ/–≤–∫–ª–∞–¥–∫—É)")
            return True
        except Exception as e:
            print(f"‚ö†Ô∏è wslview –º–µ—Ç–æ–¥ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–∫–Ω–∞: {e}")

    return False

def refresh_browser_page(url="https://trade.padre.gg/trade/solana/TQnDxmfeV9G2cVPywPG5q5Ri37RNCoRyTzA7TLsvnt1", interval_minutes=5):
    """
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–∞—É–∑–µ—Ä–∞ —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

    Args:
        url: URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        interval_minutes: –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö
    """
    print("üîÑ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—Ä–∞—É–∑–µ—Ä–∞")
    print(f"üìÑ URL: {url}")
    print(f"‚è±Ô∏è  –ò–Ω—Ç–µ—Ä–≤–∞–ª: {interval_minutes} –º–∏–Ω—É—Ç")
    print("üí° –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C")
    print("-" * 50)

    try:
        while True:
            print(f"üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã... ({time.strftime('%H:%M:%S')})")

            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
            print("üîí –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞...")
            try:
                cmd = ["powershell.exe", "-Command", "Get-Process msedge -ErrorAction SilentlyContinue | Stop-Process -Force"]
                result = subprocess.run(cmd, capture_output=True, timeout=5, text=True, encoding='cp1251')
                if result.returncode == 0:
                    print("‚úÖ –í—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –∑–∞–∫—Ä—ã—Ç—ã")
                else:
                    print("‚ÑπÔ∏è –ù–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ–∫–æ–Ω –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è")
            except Exception as e:
                print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞: {e}")

            # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è
            time.sleep(2)

            # –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –∑–∞–∫—Ä—ã–ª–∏ –≤—Å–µ –æ–∫–Ω–∞, —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ
            print(f"üîÑ –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ —Å URL...")

            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ç–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
            try:
                cmd = ["powershell.exe", "-Command", f"Start-Process 'msedge.exe' -ArgumentList '{url}'"]
                result = subprocess.run(cmd, capture_output=True, timeout=10, text=True, encoding='cp1251')
                if result.returncode == 0:
                    print("‚úÖ –ù–æ–≤–æ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–æ —Å –Ω—É–∂–Ω—ã–º URL")
                else:
                    print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä: {result.stdout.strip()}")
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞: {e}")

                # –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ cmd
                try:
                    cmd = ["cmd.exe", "/c", f"start msedge.exe {url}"]
                    subprocess.run(cmd, shell=True, capture_output=True, timeout=10)
                    print("‚úÖ –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ cmd")
                except Exception as e:
                    print(f"‚ö†Ô∏è –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ç–æ–∂–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

            # –ñ–¥–µ–º –∑–∞–¥–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            print(f"‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ {interval_minutes} –º–∏–Ω—É—Ç –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è...")
            time.sleep(interval_minutes * 60)

    except KeyboardInterrupt:
        print("\nüõë –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")

def refresh_page_once(url="https://trade.padre.gg/trade/solana/TQnDxmfeV9G2cVPywPG5q5Ri37RNCoRyTzA7TLsvnt1"):
    """
    –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    """
    print(f"üîÑ –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {url}")

    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
    print("üîí –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞...")
    try:
        cmd = ["powershell.exe", "-Command", "Get-Process msedge -ErrorAction SilentlyContinue | Stop-Process -Force"]
        result = subprocess.run(cmd, capture_output=True, timeout=5, text=True, encoding='cp1251')
        if result.returncode == 0:
            print("‚úÖ –í—Å–µ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –∑–∞–∫—Ä—ã—Ç—ã")
        else:
            print("‚ÑπÔ∏è –ù–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ–∫–æ–Ω –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è")
    except Exception as e:
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞: {e}")

    # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è
    time.sleep(2)

    print(f"üîÑ –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–æ–Ω –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Ç–∫—Ä—ã—Ç–∏—é –Ω–æ–≤–æ–≥–æ...")

    # –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–∫—Ä—ã–ª–∏ –≤—Å–µ –æ–∫–Ω–∞, —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ —Å –Ω—É–∂–Ω—ã–º URL
    print(f"üîÑ –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ —Å URL: {url}")

    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ç–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
    try:
        cmd = ["powershell.exe", "-Command", f"Start-Process 'msedge.exe' -ArgumentList '{url}'"]
        result = subprocess.run(cmd, capture_output=True, timeout=10, text=True, encoding='cp1251')
        if result.returncode == 0:
            print("‚úÖ –ù–æ–≤–æ–µ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–æ —Å –Ω—É–∂–Ω—ã–º URL")
            return True
        else:
            print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä: {result.stdout.strip()}")
    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞: {e}")

    # –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ cmd
    try:
        cmd = ["cmd.exe", "/c", f"start msedge.exe {url}"]
        subprocess.run(cmd, shell=True, capture_output=True, timeout=10)
        print("‚úÖ –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ cmd")
        return True
    except Exception as e:
        print(f"‚ö†Ô∏è –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ç–æ–∂–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: {e}")

    return False

if __name__ == "__main__":
    if len(sys.argv) > 1 and sys.argv[1] == "--once":
        # –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        url = sys.argv[2] if len(sys.argv) > 2 else "https://trade.padre.gg/trade/solana/TQnDxmfeV9G2cVPywPG5q5Ri37RNCoRyTzA7TLsvnt1"
        refresh_page_once(url)
    else:
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        interval = 1  # –º–∏–Ω—É—Ç
        if len(sys.argv) > 1:
            try:
                interval = int(sys.argv[1])
            except ValueError:
                print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∏—Å–ª–æ –º–∏–Ω—É—Ç.")

        url = "https://trade.padre.gg/trade/solana/TQnDxmfeV9G2cVPywPG5q5Ri37RNCoRyTzA7TLsvnt1"
        if len(sys.argv) > 2:
            url = sys.argv[2]

        refresh_browser_page(url, interval)
